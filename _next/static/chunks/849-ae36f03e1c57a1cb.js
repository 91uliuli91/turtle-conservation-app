(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[849],{17:(e,t,i)=>{"use strict";i.d(t,{A:()=>o});var r=i(5155),a=i(2115),s=i(9454);function o(e){let{compact:t=!1,showLocationInfo:i=!0}=e,{data:o,loading:n,error:d,deviceLocation:l,refetch:c}=function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],{location:t,loading:i,error:r}=function(){let[e,t]=(0,a.useState)(null),[i,r]=(0,a.useState)(!0),[s,o]=(0,a.useState)(null),n=()=>new Promise((e,t)=>{if(!navigator.geolocation)return void t(Error("Geolocalizaci\xf3n no soportada"));navigator.geolocation.getCurrentPosition(t=>{e({lat:t.coords.latitude,lon:t.coords.longitude,accuracy:t.coords.accuracy,timestamp:t.timestamp})},e=>{let i="Error desconocido al obtener ubicaci\xf3n";switch(e.code){case e.PERMISSION_DENIED:i="Permiso de ubicaci\xf3n denegado";break;case e.POSITION_UNAVAILABLE:i="Informaci\xf3n de ubicaci\xf3n no disponible";break;case e.TIMEOUT:i="Tiempo de espera agotado"}t(Error(i))},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5})});return(0,a.useEffect)(()=>{(async()=>{try{r(!0),o(null);let e=await n();t(e),console.log(" Ubicaci\xf3n del dispositivo obtenida:",e)}catch(e){o(e instanceof Error?e.message:"Error desconocido"),console.error(" Error obteniendo ubicaci\xf3n:",e)}finally{r(!1)}})()},[]),{location:e,loading:i,error:s,refetch:async()=>{try{r(!0),o(null);let e=await n();return t(e),e}catch(e){throw o(e instanceof Error?e.message:"Error desconocido"),e}finally{r(!1)}}}}(),[o,n]=(0,a.useState)(null),[d,l]=(0,a.useState)(!0),[c,u]=(0,a.useState)(null),m=async(e,t)=>{try{l(!0),u(null),console.log("\uD83D\uDD04 Obteniendo datos ambientales para ubicaci\xf3n actual...");let i=await s.weatherService.getEnvironmentalData(e,t);n(i)}catch(e){u(e instanceof Error?e.message:"Error desconocido al obtener datos ambientales"),console.error("❌ Error en useEnvironmentalData:",e)}finally{l(!1)}};(0,a.useEffect)(()=>{t&&!i?m(t.lat,t.lon):r&&!i&&(u("Ubicaci\xf3n: ".concat(r)),l(!1))},[t,i,r]),(0,a.useEffect)(()=>{if(t&&e){let e=setInterval(()=>{m(t.lat,t.lon)},18e5);return()=>clearInterval(e)}},[t,e]);let h=async()=>{t&&await m(t.lat,t.lon)};return{data:o,loading:d||i,error:c||r,deviceLocation:t,refetch:h}}();return n?(0,r.jsxs)("div",{className:"bg-card rounded-2xl p-4 border border-border/50 ".concat(t?"mb-4":"mb-6"),children:[(0,r.jsxs)("div",{className:"flex items-center justify-center space-x-2 text-muted-foreground",children:[(0,r.jsx)("div",{className:"w-4 h-4 border-2 border-primary border-t-transparent rounded-full animate-spin"}),(0,r.jsx)("span",{className:"text-sm",children:l?"Obteniendo datos ambientales...":"Obteniendo ubicaci\xf3n..."})]}),!l&&(0,r.jsx)("p",{className:"text-xs text-muted-foreground text-center mt-2",children:"Por favor, permite el acceso a tu ubicaci\xf3n"})]}):d?(0,r.jsx)("div",{className:"bg-card rounded-2xl p-4 border border-destructive/20 ".concat(t?"mb-4":"mb-6"),children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-destructive mb-2",children:"⚠️ No se pudieron cargar los datos"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground mb-3",children:d}),(0,r.jsx)("button",{onClick:c,className:"text-xs bg-secondary px-3 py-1 rounded-lg hover:bg-accent transition-colors",children:"Reintentar"})]})}):o?t?(0,r.jsxs)("div",{className:"bg-card rounded-2xl p-4 border border-border/50 mb-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-foreground",children:"Condiciones Actuales"}),i&&l&&(0,r.jsxs)("span",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[(0,r.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"})}),"Tu ubicaci\xf3n"]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-3 text-center",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("div",{className:"text-xs text-muted-foreground",children:"\uD83C\uDF21️ Temp"}),(0,r.jsxs)("div",{className:"text-sm font-semibold text-foreground",children:[o.weather.temperature,"\xb0C"]})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("div",{className:"text-xs text-muted-foreground",children:"\uD83D\uDCA7 Hum"}),(0,r.jsxs)("div",{className:"text-sm font-semibold text-foreground",children:[o.weather.humidity,"%"]})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("div",{className:"text-xs text-muted-foreground",children:"\uD83C\uDF0A Marea"}),(0,r.jsx)("div",{className:"text-sm font-semibold text-foreground",children:o.tide.tideHeight>0?"".concat(o.tide.tideHeight,"m"):"--"})]})]}),o.tide.source&&(0,r.jsxs)("div",{className:"text-xs text-muted-foreground text-center mt-2",children:["Fuente: ",o.tide.source]})]}):(0,r.jsxs)("div",{className:"bg-card rounded-2xl p-6 border border-border/50 mb-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[(0,r.jsx)("svg",{className:"w-5 h-5 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z"})}),"Condiciones en Tu Ubicaci\xf3n"]}),i&&l&&(0,r.jsxs)("p",{className:"text-sm text-muted-foreground mt-1 flex items-center gap-1",children:[(0,r.jsxs)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Ubicaci\xf3n actual • Precisi\xf3n: \xb1",Math.round(l.accuracy),"m"]})]}),(0,r.jsxs)("button",{onClick:c,className:"text-xs bg-secondary px-3 py-1 rounded-lg hover:bg-accent transition-colors flex items-center gap-1",children:[(0,r.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Actualizar"]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,r.jsxs)("div",{className:"bg-gradient-to-br from-orange-500/10 to-red-500/10 rounded-xl p-3 border border-orange-500/20",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-lg bg-orange-500/20 flex items-center justify-center",children:(0,r.jsx)("svg",{className:"w-4 h-4 text-orange-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})})}),(0,r.jsx)("div",{className:"text-sm font-medium text-foreground",children:"Temperatura"})]}),(0,r.jsxs)("div",{className:"text-2xl font-bold text-foreground",children:[o.weather.temperature,"\xb0C"]}),(0,r.jsxs)("div",{className:"text-xs text-muted-foreground mt-1",children:["Sensaci\xf3n: ",o.weather.feelsLike,"\xb0C"]})]}),(0,r.jsxs)("div",{className:"bg-gradient-to-br from-blue-500/10 to-cyan-500/10 rounded-xl p-3 border border-blue-500/20",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-lg bg-blue-500/20 flex items-center justify-center",children:(0,r.jsx)("svg",{className:"w-4 h-4 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z"})})}),(0,r.jsx)("div",{className:"text-sm font-medium text-foreground",children:"Humedad"})]}),(0,r.jsxs)("div",{className:"text-2xl font-bold text-foreground",children:[o.weather.humidity,"%"]}),(0,r.jsx)("div",{className:"text-xs text-muted-foreground mt-1 capitalize",children:o.weather.weatherCondition})]}),(0,r.jsxs)("div",{className:"bg-gradient-to-br from-purple-500/10 to-pink-500/10 rounded-xl p-3 border border-purple-500/20",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-lg bg-purple-500/20 flex items-center justify-center",children:(0,r.jsx)("svg",{className:"w-4 h-4 text-purple-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7l4-4m0 0l4 4m-4-4v18m0 0l-4-4m4 4l4-4"})})}),(0,r.jsx)("div",{className:"text-sm font-medium text-foreground",children:"Marea"})]}),(0,r.jsxs)("div",{className:"text-2xl font-bold text-foreground",children:[o.tide.tideHeight,"m"]}),(0,r.jsxs)("div",{className:"text-xs text-muted-foreground mt-1",children:["high"===o.tide.tideStatus&&"\uD83C\uDF0A Pleamar","low"===o.tide.tideStatus&&"\uD83D\uDD3B Bajamar","rising"===o.tide.tideStatus&&"\uD83D\uDCC8 Subiendo","falling"===o.tide.tideStatus&&"\uD83D\uDCC9 Bajando","--:--"!==o.tide.highTide&&" • Alta: ".concat(o.tide.highTide)]})]}),(0,r.jsxs)("div",{className:"bg-gradient-to-br from-indigo-500/10 to-purple-500/10 rounded-xl p-3 border border-indigo-500/20",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,r.jsx)("div",{className:"text-2xl",children:o.moonPhase.icon}),(0,r.jsx)("div",{className:"text-sm font-medium text-foreground",children:"Luna"})]}),(0,r.jsx)("div",{className:"text-lg font-bold text-foreground",children:o.moonPhase.phase}),(0,r.jsxs)("div",{className:"text-xs text-muted-foreground mt-1",children:[o.moonPhase.illumination,"% iluminada"]})]})]}),(0,r.jsxs)("div",{className:"mt-4 pt-4 border-t border-border/30",children:[(0,r.jsxs)("div",{className:"text-xs text-muted-foreground",children:[(0,r.jsx)("strong",{children:"Fuentes:"})," Clima: OpenWeatherMap • Mareas: WorldTides • Luna: C\xe1lculo astron\xf3mico • Ubicaci\xf3n: Dispositivo GPS"]}),(0,r.jsxs)("div",{className:"text-xs text-muted-foreground mt-1",children:["Actualizado: ",o.timestamp,l&&(0,r.jsxs)("span",{children:[" • Coord: ",l.lat.toFixed(4),", ",l.lon.toFixed(4)]})]})]})]}):null}},3673:()=>{},9454:(e,t,i)=>{"use strict";i.d(t,{weatherService:()=>s});var r=i(5704);class a{async getWeatherData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.defaultLocation.lat,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.defaultLocation.lon;try{console.log("\uD83C\uDF24️ Obteniendo datos clim\xe1ticos REALES...");let i=await fetch("".concat(this.weatherBaseURL,"/weather?lat=").concat(e,"&lon=").concat(t,"&appid=").concat(this.weatherAPIKey,"&units=metric&lang=es"));if(!i.ok)throw Error("Error HTTP: ".concat(i.status));let r=await i.json();return{temperature:Math.round(r.main.temp),humidity:r.main.humidity,weatherCondition:r.weather[0].description,windSpeed:Math.round(3.6*r.wind.speed),pressure:r.main.pressure,visibility:r.visibility/1e3,feelsLike:Math.round(r.main.feels_like)}}catch(e){throw console.error("❌ Error obteniendo datos clim\xe1ticos:",e),Error("No se pudieron obtener los datos clim\xe1ticos")}}async getTideData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.defaultLocation.lat,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.defaultLocation.lon;console.log("\uD83C\uDF0A Generando estimaci\xf3n de mareas para:",{lat:e,lon:t});try{return this.getIntelligentTideEstimation(e,t)}catch(e){return console.warn("⚠️ Error en estimaci\xf3n de mareas, usando fallback b\xe1sico"),this.getBasicTideFallback()}}getIntelligentTideEstimation(e,t){let i=new Date().getTime(),r=this.detectGeographicRegion(e,t),a=this.getTideParametersForRegion(r),{currentHeight:s,tidePhase:o,nextHighTideTime:n,nextLowTideTime:d,tideStatus:l}=this.calculateTideCycle(i,a),c=new Date(n),u=new Date(d),m=new Date(n+60*a.cycleHours*6e4);return{highTide:c.toLocaleTimeString("es-MX",{hour:"2-digit",minute:"2-digit"}),lowTide:u.toLocaleTimeString("es-MX",{hour:"2-digit",minute:"2-digit"}),nextHighTide:m.toLocaleTimeString("es-MX",{hour:"2-digit",minute:"2-digit"}),tideHeight:Math.round(10*s)/10,tideStatus:l,source:"Sistema de estimaci\xf3n local",station:"Regi\xf3n ".concat(r)}}detectGeographicRegion(e,t){if(e>=20.5&&e<=21.5&&t>=-87.5&&t<=-86);else if(e>=18&&e<=25&&t>=-97&&t<=-90)return"gulf";else if(e>=14&&e<=32&&t>=-118&&t<=-86)return"pacific";return"caribbean"}getTideParametersForRegion(e){let t={caribbean:{baseHeight:.7,amplitude:.3,cycleHours:6.21,highTideOffset:2.5},gulf:{baseHeight:.9,amplitude:.5,cycleHours:6.12,highTideOffset:3.1},pacific:{baseHeight:1.2,amplitude:.8,cycleHours:6.4,highTideOffset:1.8}};return t[e]||t.caribbean}calculateTideCycle(e,t){let i=new Date(e),r=i.getHours(),a=(r+i.getMinutes()/60+t.highTideOffset)/t.cycleHours*Math.PI*2,s=t.baseHeight+Math.sin(a)*t.amplitude,o=this.calculateHoursToNextExtreme(a,"high",t.cycleHours),n=this.calculateHoursToNextExtreme(a,"low",t.cycleHours),d=Math.sin(a);return{currentHeight:Math.max(.1,s),tidePhase:a,nextHighTideTime:e+60*o*6e4,nextLowTideTime:e+60*n*6e4,tideStatus:d>.9?"high":d<-.9?"low":d>0?"rising":"falling"}}calculateHoursToNextExtreme(e,t,i){let r=("high"===t?Math.PI/2:3*Math.PI/2)-e;return r<0&&(r+=2*Math.PI),r/(2*Math.PI)*i}getBasicTideFallback(){let e=new Date,t=new Date(e.getTime()+108e5),i=new Date(e.getTime()+324e5);return{highTide:t.toLocaleTimeString("es-MX",{hour:"2-digit",minute:"2-digit"}),lowTide:i.toLocaleTimeString("es-MX",{hour:"2-digit",minute:"2-digit"}),nextHighTide:t.toLocaleTimeString("es-MX",{hour:"2-digit",minute:"2-digit"}),tideHeight:.8,tideStatus:"rising",source:"Sistema de estimaci\xf3n (fallback)",station:"Estimaci\xf3n regional"}}getMoonPhase(){let e=new Date,t=new Date(2e3,0,6,18,14,0),i=(e.getTime()-t.getTime())/864e5%29.530588853,r="",a=0,s="";i<1.84566?(r="Luna Nueva",a=0,s="\uD83C\uDF11"):i<5.53699?(r="Luna Creciente",a=.25,s="\uD83C\uDF12"):i<9.22831?(r="Cuarto Creciente",a=.5,s="\uD83C\uDF13"):i<12.91963?(r="Gibosa Creciente",a=.75,s="\uD83C\uDF14"):i<16.61096?(r="Luna Llena",a=1,s="\uD83C\uDF15"):i<20.30228?(r="Gibosa Menguante",a=.75,s="\uD83C\uDF16"):i<23.99361?(r="Cuarto Menguante",a=.5,s="\uD83C\uDF17"):(r="Luna Menguante",a=.25,s="\uD83C\uDF18");let o=new Date(e.getTime()+(14.77-i)*864e5),n=new Date(e.getTime()+(29.53-i)*864e5);return{phase:r,illumination:Math.round(100*a),age:Math.round(10*i)/10,icon:s,nextFullMoon:o.toLocaleDateString("es-MX"),nextNewMoon:n.toLocaleDateString("es-MX")}}async getEnvironmentalData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.defaultLocation.lat,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.defaultLocation.lon;try{console.log("\uD83D\uDCCD Obteniendo datos ambientales...");let[i,r,a]=await Promise.all([this.getWeatherData(e,t),this.getTideData(e,t),Promise.resolve(this.getMoonPhase())]),s={weather:i,tide:r,moonPhase:a,timestamp:new Date().toLocaleString("es-MX"),location:{lat:e,lon:t,name:this.defaultLocation.name}};return console.log("✅ Datos ambientales obtenidos (con estimaci\xf3n local):",s),s}catch(e){throw console.error("❌ Error obteniendo datos ambientales:",e),e}}constructor(){this.weatherAPIKey=r.env.NEXT_PUBLIC_WEATHER_API_KEY||"574429463481570e1d702f1c11168da0",this.weatherBaseURL="https://api.openweathermap.org/data/2.5",this.defaultLocation={lat:21.1619,lon:-86.8515,name:"Canc\xfan, M\xe9xico"}}}let s=new a}}]);