(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[849],{17:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var o=r(5155),a=r(2115),s=r(9454);function i(e){let{compact:t=!1,showLocationInfo:r=!0}=e,{data:i,loading:n,error:d,deviceLocation:l,refetch:c}=function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],{location:t,loading:r,error:o}=function(){let[e,t]=(0,a.useState)(null),[r,o]=(0,a.useState)(!0),[s,i]=(0,a.useState)(null),n=()=>new Promise((e,t)=>{if(!navigator.geolocation)return void t(Error("Geolocalizaci\xf3n no soportada"));navigator.geolocation.getCurrentPosition(t=>{e({lat:t.coords.latitude,lon:t.coords.longitude,accuracy:t.coords.accuracy,timestamp:t.timestamp})},e=>{let r="Error desconocido al obtener ubicaci\xf3n";switch(e.code){case e.PERMISSION_DENIED:r="Permiso de ubicaci\xf3n denegado";break;case e.POSITION_UNAVAILABLE:r="Informaci\xf3n de ubicaci\xf3n no disponible";break;case e.TIMEOUT:r="Tiempo de espera agotado"}t(Error(r))},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5})});return(0,a.useEffect)(()=>{(async()=>{try{o(!0),i(null);let e=await n();t(e),console.log(" Ubicaci\xf3n del dispositivo obtenida:",e)}catch(e){i(e instanceof Error?e.message:"Error desconocido"),console.error(" Error obteniendo ubicaci\xf3n:",e)}finally{o(!1)}})()},[]),{location:e,loading:r,error:s,refetch:async()=>{try{o(!0),i(null);let e=await n();return t(e),e}catch(e){throw i(e instanceof Error?e.message:"Error desconocido"),e}finally{o(!1)}}}}(),[i,n]=(0,a.useState)(null),[d,l]=(0,a.useState)(!0),[c,m]=(0,a.useState)(null),u=async(e,t)=>{try{l(!0),m(null),console.log("\uD83D\uDD04 Obteniendo datos ambientales para ubicaci\xf3n actual...");let r=await s.weatherService.getEnvironmentalData(e,t);n(r)}catch(e){m(e instanceof Error?e.message:"Error desconocido al obtener datos ambientales"),console.error("❌ Error en useEnvironmentalData:",e)}finally{l(!1)}};(0,a.useEffect)(()=>{t&&!r?u(t.lat,t.lon):o&&!r&&(m("Ubicaci\xf3n: ".concat(o)),l(!1))},[t,r,o]),(0,a.useEffect)(()=>{if(t&&e){let e=setInterval(()=>{u(t.lat,t.lon)},18e5);return()=>clearInterval(e)}},[t,e]);let h=async()=>{t&&await u(t.lat,t.lon)};return{data:i,loading:d||r,error:c||o,deviceLocation:t,refetch:h}}();return n?(0,o.jsxs)("div",{className:"bg-card rounded-2xl p-4 border border-border/50 ".concat(t?"mb-4":"mb-6"),children:[(0,o.jsxs)("div",{className:"flex items-center justify-center space-x-2 text-muted-foreground",children:[(0,o.jsx)("div",{className:"w-4 h-4 border-2 border-primary border-t-transparent rounded-full animate-spin"}),(0,o.jsx)("span",{className:"text-sm",children:l?"Obteniendo datos ambientales...":"Obteniendo ubicaci\xf3n..."})]}),!l&&(0,o.jsx)("p",{className:"text-xs text-muted-foreground text-center mt-2",children:"Por favor, permite el acceso a tu ubicaci\xf3n"})]}):d?(0,o.jsx)("div",{className:"bg-card rounded-2xl p-4 border border-destructive/20 ".concat(t?"mb-4":"mb-6"),children:(0,o.jsxs)("div",{className:"text-center",children:[(0,o.jsx)("div",{className:"text-destructive mb-2",children:"⚠️ No se pudieron cargar los datos"}),(0,o.jsx)("p",{className:"text-sm text-muted-foreground mb-3",children:d}),(0,o.jsx)("button",{onClick:c,className:"text-xs bg-secondary px-3 py-1 rounded-lg hover:bg-accent transition-colors",children:"Reintentar"})]})}):i?t?(0,o.jsxs)("div",{className:"bg-card rounded-2xl p-4 border border-border/50 mb-4",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,o.jsx)("span",{className:"text-sm font-medium text-foreground",children:"Condiciones Actuales"}),r&&l&&(0,o.jsxs)("span",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[(0,o.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"})}),"Tu ubicaci\xf3n"]})]}),(0,o.jsxs)("div",{className:"grid grid-cols-3 gap-3 text-center",children:[(0,o.jsxs)("div",{className:"space-y-1",children:[(0,o.jsx)("div",{className:"text-xs text-muted-foreground",children:"\uD83C\uDF21️ Temp"}),(0,o.jsxs)("div",{className:"text-sm font-semibold text-foreground",children:[i.weather.temperature,"\xb0C"]})]}),(0,o.jsxs)("div",{className:"space-y-1",children:[(0,o.jsx)("div",{className:"text-xs text-muted-foreground",children:"\uD83D\uDCA7 Hum"}),(0,o.jsxs)("div",{className:"text-sm font-semibold text-foreground",children:[i.weather.humidity,"%"]})]}),(0,o.jsxs)("div",{className:"space-y-1",children:[(0,o.jsx)("div",{className:"text-xs text-muted-foreground",children:"\uD83C\uDF0A Marea"}),(0,o.jsx)("div",{className:"text-sm font-semibold text-foreground",children:i.tide.tideHeight>0?"".concat(i.tide.tideHeight,"m"):"--"})]})]}),i.tide.source&&(0,o.jsxs)("div",{className:"text-xs text-muted-foreground text-center mt-2",children:["Fuente: ",i.tide.source]})]}):(0,o.jsxs)("div",{className:"bg-card rounded-2xl p-6 border border-border/50 mb-6",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsxs)("h3",{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[(0,o.jsx)("svg",{className:"w-5 h-5 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z"})}),"Condiciones en Tu Ubicaci\xf3n"]}),r&&l&&(0,o.jsxs)("p",{className:"text-sm text-muted-foreground mt-1 flex items-center gap-1",children:[(0,o.jsxs)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Ubicaci\xf3n actual • Precisi\xf3n: \xb1",Math.round(l.accuracy),"m"]})]}),(0,o.jsxs)("button",{onClick:c,className:"text-xs bg-secondary px-3 py-1 rounded-lg hover:bg-accent transition-colors flex items-center gap-1",children:[(0,o.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Actualizar"]})]}),(0,o.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,o.jsxs)("div",{className:"bg-gradient-to-br from-orange-500/10 to-red-500/10 rounded-xl p-3 border border-orange-500/20",children:[(0,o.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,o.jsx)("div",{className:"w-8 h-8 rounded-lg bg-orange-500/20 flex items-center justify-center",children:(0,o.jsx)("svg",{className:"w-4 h-4 text-orange-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})})}),(0,o.jsx)("div",{className:"text-sm font-medium text-foreground",children:"Temperatura"})]}),(0,o.jsxs)("div",{className:"text-2xl font-bold text-foreground",children:[i.weather.temperature,"\xb0C"]}),(0,o.jsxs)("div",{className:"text-xs text-muted-foreground mt-1",children:["Sensaci\xf3n: ",i.weather.feelsLike,"\xb0C"]})]}),(0,o.jsxs)("div",{className:"bg-gradient-to-br from-blue-500/10 to-cyan-500/10 rounded-xl p-3 border border-blue-500/20",children:[(0,o.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,o.jsx)("div",{className:"w-8 h-8 rounded-lg bg-blue-500/20 flex items-center justify-center",children:(0,o.jsx)("svg",{className:"w-4 h-4 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z"})})}),(0,o.jsx)("div",{className:"text-sm font-medium text-foreground",children:"Humedad"})]}),(0,o.jsxs)("div",{className:"text-2xl font-bold text-foreground",children:[i.weather.humidity,"%"]}),(0,o.jsx)("div",{className:"text-xs text-muted-foreground mt-1 capitalize",children:i.weather.weatherCondition})]}),(0,o.jsxs)("div",{className:"bg-gradient-to-br from-purple-500/10 to-pink-500/10 rounded-xl p-3 border border-purple-500/20",children:[(0,o.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,o.jsx)("div",{className:"w-8 h-8 rounded-lg bg-purple-500/20 flex items-center justify-center",children:(0,o.jsx)("svg",{className:"w-4 h-4 text-purple-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7l4-4m0 0l4 4m-4-4v18m0 0l-4-4m4 4l4-4"})})}),(0,o.jsx)("div",{className:"text-sm font-medium text-foreground",children:"Marea"})]}),(0,o.jsxs)("div",{className:"text-2xl font-bold text-foreground",children:[i.tide.tideHeight,"m"]}),(0,o.jsxs)("div",{className:"text-xs text-muted-foreground mt-1",children:["high"===i.tide.tideStatus&&"\uD83C\uDF0A Pleamar","low"===i.tide.tideStatus&&"\uD83D\uDD3B Bajamar","rising"===i.tide.tideStatus&&"\uD83D\uDCC8 Subiendo","falling"===i.tide.tideStatus&&"\uD83D\uDCC9 Bajando","--:--"!==i.tide.highTide&&" • Alta: ".concat(i.tide.highTide)]})]}),(0,o.jsxs)("div",{className:"bg-gradient-to-br from-indigo-500/10 to-purple-500/10 rounded-xl p-3 border border-indigo-500/20",children:[(0,o.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,o.jsx)("div",{className:"text-2xl",children:i.moonPhase.icon}),(0,o.jsx)("div",{className:"text-sm font-medium text-foreground",children:"Luna"})]}),(0,o.jsx)("div",{className:"text-lg font-bold text-foreground",children:i.moonPhase.phase}),(0,o.jsxs)("div",{className:"text-xs text-muted-foreground mt-1",children:[i.moonPhase.illumination,"% iluminada"]})]})]}),(0,o.jsxs)("div",{className:"mt-4 pt-4 border-t border-border/30",children:[(0,o.jsxs)("div",{className:"text-xs text-muted-foreground",children:[(0,o.jsx)("strong",{children:"Fuentes:"})," Clima: OpenWeatherMap • Mareas: WorldTides • Luna: C\xe1lculo astron\xf3mico • Ubicaci\xf3n: Dispositivo GPS"]}),(0,o.jsxs)("div",{className:"text-xs text-muted-foreground mt-1",children:["Actualizado: ",i.timestamp,l&&(0,o.jsxs)("span",{children:[" • Coord: ",l.lat.toFixed(4),", ",l.lon.toFixed(4)]})]})]})]}):null}},3673:()=>{},9454:(e,t,r)=>{"use strict";r.d(t,{weatherService:()=>s});var o=r(5704);class a{async getWeatherData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.defaultLocation.lat,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.defaultLocation.lon;try{console.log("\uD83C\uDF24️ Obteniendo datos clim\xe1ticos REALES...");let r=await fetch("".concat(this.weatherBaseURL,"/weather?lat=").concat(e,"&lon=").concat(t,"&appid=").concat(this.weatherAPIKey,"&units=metric&lang=es"));if(!r.ok)throw Error("Error HTTP: ".concat(r.status));let o=await r.json();return{temperature:Math.round(o.main.temp),humidity:o.main.humidity,weatherCondition:o.weather[0].description,windSpeed:Math.round(3.6*o.wind.speed),pressure:o.main.pressure,visibility:o.visibility/1e3,feelsLike:Math.round(o.main.feels_like)}}catch(e){throw console.error("❌ Error obteniendo datos clim\xe1ticos:",e),Error("No se pudieron obtener los datos clim\xe1ticos")}}async getTideData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.defaultLocation.lat,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.defaultLocation.lon;try{console.log("\uD83C\uDF0A Obteniendo datos REALES de mareas de WorldTides...");let r=await fetch("".concat(this.tidesBaseURL,"?extremes&lat=").concat(e,"&lon=").concat(t,"&key=").concat(this.tidesAPIKey));if(!r.ok)throw Error("WorldTides API error: ".concat(r.status));let o=await r.json();return console.log("✅ Datos REALES de WorldTides:",o),this.processWorldTidesData(o,e,t)}catch(e){throw console.error("❌ Error obteniendo datos de mareas REALES:",e),Error("No se pudieron obtener los datos de mareas de WorldTides")}}processWorldTidesData(e,t,r){let o=new Date().getTime();if(!e.extremes||0===e.extremes.length)throw Error("No hay datos de mareas disponibles para esta ubicaci\xf3n");let a=null,s=null,i=0;for(let t of e.extremes){let e=new Date(1e3*t.dt).getTime();"High"===t.type&&(!a||e<1e3*a.dt)&&(a=t),"Low"===t.type&&(!s||e<1e3*s.dt)&&(s=t),72e5>Math.abs(e-o)&&(i=t.height)}0===i&&e.extremes.length>0&&(i=e.extremes[0].height);let n="rising";if(a&&s){let e=new Date(1e3*a.dt).getTime(),t=new Date(1e3*s.dt).getTime();n=o>e-36e5&&o<e+36e5?"high":o>t-36e5&&o<t+36e5?"low":o<e?"rising":"falling"}return{highTide:a?new Date(1e3*a.dt).toLocaleTimeString("es-MX",{hour:"2-digit",minute:"2-digit"}):"--:--",lowTide:s?new Date(1e3*s.dt).toLocaleTimeString("es-MX",{hour:"2-digit",minute:"2-digit"}):"--:--",nextHighTide:a?new Date(1e3*a.dt).toLocaleTimeString("es-MX",{hour:"2-digit",minute:"2-digit"}):"--:--",tideHeight:Math.round(10*i)/10,tideStatus:n,source:"WorldTides",station:e.station||"Estaci\xf3n m\xe1s cercana"}}getCacheKey(e,t,r){return"".concat(e,",").concat(t,",").concat(r)}getFromCache(e){let t=this.cache.get(e);return t&&Date.now()-t.timestamp<this.CACHE_DURATION?t.data:null}getMoonPhase(){let e=new Date,t=new Date(2e3,0,6,18,14,0),r=(e.getTime()-t.getTime())/864e5%29.530588853,o="",a=0,s="";r<1.84566?(o="Luna Nueva",a=0,s="\uD83C\uDF11"):r<5.53699?(o="Luna Creciente",a=.25,s="\uD83C\uDF12"):r<9.22831?(o="Cuarto Creciente",a=.5,s="\uD83C\uDF13"):r<12.91963?(o="Gibosa Creciente",a=.75,s="\uD83C\uDF14"):r<16.61096?(o="Luna Llena",a=1,s="\uD83C\uDF15"):r<20.30228?(o="Gibosa Menguante",a=.75,s="\uD83C\uDF16"):r<23.99361?(o="Cuarto Menguante",a=.5,s="\uD83C\uDF17"):(o="Luna Menguante",a=.25,s="\uD83C\uDF18");let i=new Date(e.getTime()+(14.77-r)*864e5),n=new Date(e.getTime()+(29.53-r)*864e5);return{phase:o,illumination:Math.round(100*a),age:Math.round(10*r)/10,icon:s,nextFullMoon:i.toLocaleDateString("es-MX"),nextNewMoon:n.toLocaleDateString("es-MX")}}async getEnvironmentalData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.defaultLocation.lat,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.defaultLocation.lon;try{console.log("\uD83D\uDCCD Obteniendo datos ambientales REALES para:",{lat:e,lon:t});let[r,o,a]=await Promise.all([this.getWeatherData(e,t),this.getTideData(e,t),Promise.resolve(this.getMoonPhase())]),s={weather:r,tide:o,moonPhase:a,timestamp:new Date().toLocaleString("es-MX"),location:{lat:e,lon:t,name:this.defaultLocation.name}};return console.log("✅ Todos los datos REALES obtenidos:",s),s}catch(e){throw console.error("❌ Error obteniendo datos ambientales REALES:",e),e}}async getTideForecast(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.defaultLocation.lat,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.defaultLocation.lon,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;try{let o=await fetch("".concat(this.tidesBaseURL,"?extremes&lat=").concat(e,"&lon=").concat(t,"&length=").concat(24*r*60,"&key=").concat(this.tidesAPIKey));if(!o.ok)throw Error("WorldTides forecast error: ".concat(o.status));return await o.json()}catch(e){throw console.error("Error obteniendo pron\xf3stico de mareas:",e),e}}constructor(){this.weatherAPIKey=o.env.NEXT_PUBLIC_WEATHER_API_KEY||"574429463481570e1d702f1c11168da0",this.weatherBaseURL="https://api.openweathermap.org/data/2.5",this.tidesAPIKey=o.env.NEXT_PUBLIC_TIDES_API_KEY||"1de48ffd-5337-47c7-828f-d46b9f12525c",this.tidesBaseURL="https://www.worldtides.info/api/v2",this.defaultLocation={lat:21.1619,lon:-86.8515,name:"Canc\xfan, M\xe9xico"},this.cache=new Map,this.CACHE_DURATION=3e5}}let s=new a}}]);